import { Component, EventEmitter, Input, Output } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../../materialgrammi.service";
import * as i2 from "@angular/common";
import * as i3 from "@angular/router";
function ButtonComponent_ng_container_0_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function ButtonComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    const _r7 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "a", 2);
    i0.ɵɵlistener("click", function ButtonComponent_ng_container_0_Template_a_click_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.isClicked(); })("mouseenter", function ButtonComponent_ng_container_0_Template_a_mouseenter_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r8 = i0.ɵɵnextContext(); return ctx_r8.mouseEnter(); })("mouseleave", function ButtonComponent_ng_container_0_Template_a_mouseleave_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r9 = i0.ɵɵnextContext(); return ctx_r9.mouseLeave(); })("mousedown", function ButtonComponent_ng_container_0_Template_a_mousedown_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r10 = i0.ɵɵnextContext(); return ctx_r10.mousedown(); })("mouseup", function ButtonComponent_ng_container_0_Template_a_mouseup_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r11 = i0.ɵɵnextContext(); return ctx_r11.mouseup(); });
    i0.ɵɵtemplate(2, ButtonComponent_ng_container_0_ng_container_2_Template, 1, 0, "ng-container", 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    const _r3 = i0.ɵɵreference(4);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngClass", ctx_r0.btnClasses())("href", ctx_r0.route, i0.ɵɵsanitizeUrl)("target", ctx_r0.newTab ? "_blank" : "_self");
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", _r3);
} }
function ButtonComponent_ng_container_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function ButtonComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r14 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "a", 4);
    i0.ɵɵlistener("click", function ButtonComponent_ng_container_1_Template_a_click_1_listener() { i0.ɵɵrestoreView(_r14); const ctx_r13 = i0.ɵɵnextContext(); return ctx_r13.isClicked(); })("mouseenter", function ButtonComponent_ng_container_1_Template_a_mouseenter_1_listener() { i0.ɵɵrestoreView(_r14); const ctx_r15 = i0.ɵɵnextContext(); return ctx_r15.mouseEnter(); })("mouseleave", function ButtonComponent_ng_container_1_Template_a_mouseleave_1_listener() { i0.ɵɵrestoreView(_r14); const ctx_r16 = i0.ɵɵnextContext(); return ctx_r16.mouseLeave(); })("mousedown", function ButtonComponent_ng_container_1_Template_a_mousedown_1_listener() { i0.ɵɵrestoreView(_r14); const ctx_r17 = i0.ɵɵnextContext(); return ctx_r17.mousedown(); })("mouseup", function ButtonComponent_ng_container_1_Template_a_mouseup_1_listener() { i0.ɵɵrestoreView(_r14); const ctx_r18 = i0.ɵɵnextContext(); return ctx_r18.mouseup(); });
    i0.ɵɵtemplate(2, ButtonComponent_ng_container_1_ng_container_2_Template, 1, 0, "ng-container", 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    const _r3 = i0.ɵɵreference(4);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngClass", ctx_r1.btnClasses())("routerLink", ctx_r1.route);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", _r3);
} }
function ButtonComponent_ng_container_2_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function ButtonComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    const _r21 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "a", 5);
    i0.ɵɵlistener("click", function ButtonComponent_ng_container_2_Template_a_click_1_listener() { i0.ɵɵrestoreView(_r21); const ctx_r20 = i0.ɵɵnextContext(); return ctx_r20.isClicked(); })("mouseenter", function ButtonComponent_ng_container_2_Template_a_mouseenter_1_listener() { i0.ɵɵrestoreView(_r21); const ctx_r22 = i0.ɵɵnextContext(); return ctx_r22.mouseEnter(); })("mouseleave", function ButtonComponent_ng_container_2_Template_a_mouseleave_1_listener() { i0.ɵɵrestoreView(_r21); const ctx_r23 = i0.ɵɵnextContext(); return ctx_r23.mouseLeave(); })("mousedown", function ButtonComponent_ng_container_2_Template_a_mousedown_1_listener() { i0.ɵɵrestoreView(_r21); const ctx_r24 = i0.ɵɵnextContext(); return ctx_r24.mousedown(); })("mouseup", function ButtonComponent_ng_container_2_Template_a_mouseup_1_listener() { i0.ɵɵrestoreView(_r21); const ctx_r25 = i0.ɵɵnextContext(); return ctx_r25.mouseup(); });
    i0.ɵɵtemplate(2, ButtonComponent_ng_container_2_ng_container_2_Template, 1, 0, "ng-container", 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    const _r3 = i0.ɵɵreference(4);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngClass", ctx_r2.btnClasses());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", _r3);
} }
function ButtonComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵprojection(0);
} }
const _c0 = ["*"];
export class ButtonComponent {
    constructor(service) {
        this.service = service;
        this.clicked = new EventEmitter();
        this.taskType = "none";
        this.btnStyle = "solid";
        this.task = "open";
        this.target = "/";
        this.theme = "default";
        this.class = "";
        this.btnSize = "md";
        this.isBlock = false;
        this.round = false;
        this.allowMargin = true;
        this.link = "";
        this.allowShrink = true;
        this.options = {};
        this.isExternalLink = false;
        this.newTab = false;
        this.active = new EventEmitter();
        this.route = [""];
        this.buttonType = "none";
        this.buttonClasses = "";
        this.shrink = false;
    }
    ngOnInit() {
        if (this.taskType != "link") {
            this.route = [""];
        }
        else {
            this.route = this.target;
        }
        if (this.isExternalLink && this.taskType == "link") {
            this.buttonType = "external";
        }
        else if (!this.isExternalLink && this.taskType == "link") {
            this.buttonType = "internal";
        }
        else {
            this.buttonType = "widget";
        }
    }
    isClicked() {
        this.clicked.emit(true);
        if (this.taskType == "modal") {
            this.modal();
        }
        else if (this.taskType == "offCanvas") {
            this.offCanvas();
        }
        else if (this.taskType == "slideShow") {
            this.slideShow();
        }
        else if (this.taskType == "wizard") {
            this.wizard();
        }
        else if (this.taskType == "collapse") {
            this.collapse();
        }
        else if (this.taskType == "overlay") {
            this.overlay();
        }
    }
    btnClasses() {
        this.buttonClasses = this.class + " " + this.theme;
        this.buttonClasses += ` ${this.btnSize}`;
        this.buttonClasses += this.shrink ? " shrink" : "";
        this.buttonClasses += this.isBlock ? ` btn-block` : ``;
        this.buttonClasses += this.btnStyle == "link" ? " link" : (this.btnStyle == "outline" ? " btn-outline" : "");
        this.buttonClasses += this.round ? " radius-5" : "";
        this.buttonClasses += this.allowMargin ? " marginR-5" : "";
        return this.buttonClasses;
    }
    collapse() {
        if (this.task == "open") {
            this.service.openCollapse(this.target);
            this.active.emit(true);
        }
        else if (this.task == "close") {
            this.service.closeCollapse(this.target);
            this.active.emit(false);
        }
    }
    wizard() {
        if (this.task == "next") {
            this.buttonClasses += this.options.next && !this.buttonClasses.includes("disable") ? " disable" : "";
            if (this.options.next) {
                this.service.wizardNextStep(this.target);
            }
        }
        else if (this.task == "previous") {
            this.buttonClasses += this.options.previous && !this.buttonClasses.includes("disable") ? " disable" : "";
            if (this.options.previous) {
                this.service.WizardPreviousStep(this.target);
            }
        }
    }
    mouseEnter() {
        if (this.taskType == "dropdown") {
            console.log("to trigger dropdown");
            this.service.openDropDown(this.target);
        }
    }
    mouseLeave() {
        this.mouseup();
        if (this.taskType == "dropdown") {
            this.service.closeDropDown(this.target);
        }
    }
    slideShow() {
        if (this.task == "play") {
            // this.slideShowService.play(this.target);
        }
        else if (this.task == "next") {
            // this.slideShowService.next(this.target);
        }
        else if (this.task == "previous") {
            // this.slideShowService.previous(this.target);
        }
        else {
            // this.slideShowService.pause(this.target);
        }
    }
    modal() {
        if (this.task == "open") {
            this.service.openModal(this.target);
            this.active.emit(true);
        }
        else {
            this.service.closeModal(this.target);
            this.active.emit(false);
        }
    }
    overlay() {
        if (this.task == "open") {
            console.log("opening target", this.target);
            this.service.openOverlay(this.target);
            this.active.emit(true);
        }
        else {
            this.service.closeOverlay(this.target);
            this.active.emit(false);
        }
    }
    offCanvas() {
        console.log("Task type is offcanvas");
        if (this.task == "open") {
            console.log("opening target", this.target);
            this.service.openCanvas(this.target);
            this.active.emit(true);
        }
        else {
            console.log("Closing the canvas");
            this.service.closeCanvas(this.target);
            this.active.emit(false);
        }
    }
    mousedown() {
        if (this.allowShrink) {
            this.shrink = true;
        }
    }
    mouseup() {
        if (this.allowShrink) {
            this.shrink = false;
        }
    }
}
ButtonComponent.ɵfac = function ButtonComponent_Factory(t) { return new (t || ButtonComponent)(i0.ɵɵdirectiveInject(i1.MaterialgrammiService)); };
ButtonComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ButtonComponent, selectors: [["mg-button"]], inputs: { taskType: "taskType", btnStyle: "btnStyle", task: "task", target: "target", theme: "theme", class: "class", btnSize: "btnSize", isBlock: "isBlock", round: "round", allowMargin: "allowMargin", link: "link", allowShrink: "allowShrink", options: "options", isExternalLink: "isExternalLink", newTab: "newTab" }, outputs: { clicked: "clicked", active: "active" }, ngContentSelectors: _c0, decls: 5, vars: 3, consts: [[4, "ngIf"], ["mycontent", ""], [1, "btn", 3, "ngClass", "href", "target", "click", "mouseenter", "mouseleave", "mousedown", "mouseup"], [4, "ngTemplateOutlet"], [1, "btn", 3, "ngClass", "routerLink", "click", "mouseenter", "mouseleave", "mousedown", "mouseup"], [1, "btn", 3, "ngClass", "click", "mouseenter", "mouseleave", "mousedown", "mouseup"]], template: function ButtonComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef();
        i0.ɵɵtemplate(0, ButtonComponent_ng_container_0_Template, 3, 4, "ng-container", 0);
        i0.ɵɵtemplate(1, ButtonComponent_ng_container_1_Template, 3, 3, "ng-container", 0);
        i0.ɵɵtemplate(2, ButtonComponent_ng_container_2_Template, 3, 2, "ng-container", 0);
        i0.ɵɵtemplate(3, ButtonComponent_ng_template_3_Template, 1, 0, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.buttonType == "external");
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.buttonType == "internal");
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.buttonType == "widget");
    } }, directives: [i2.NgIf, i2.NgClass, i2.NgTemplateOutlet, i3.RouterLinkWithHref], styles: [""] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ButtonComponent, [{
        type: Component,
        args: [{ selector: 'mg-button', template: "<ng-container *ngIf=\"buttonType == 'external'\">\n  <a class=\"btn\" (click)=\"isClicked()\" (mouseenter)=\"mouseEnter()\" (mouseleave)=\"mouseLeave()\"\n  [ngClass]=\"btnClasses()\" [href]=\"route\" [target]=\"newTab ? '_blank' : '_self'\"\n  (mousedown)=\"mousedown()\" (mouseup)=\"mouseup()\">\n    <ng-container *ngTemplateOutlet=\"mycontent\"></ng-container>\n  </a>\n</ng-container>\n\n<ng-container *ngIf=\"buttonType == 'internal'\">\n  <a class=\"btn\" (click)=\"isClicked()\" (mouseenter)=\"mouseEnter()\"\n  (mouseleave)=\"mouseLeave()\" [ngClass]=\"btnClasses()\" [routerLink]=\"route\"\n  (mousedown)=\"mousedown()\" (mouseup)=\"mouseup()\">\n    <ng-container *ngTemplateOutlet=\"mycontent\"></ng-container>\n  </a>\n</ng-container>\n\n<ng-container *ngIf=\"buttonType == 'widget'\">\n  <a class=\"btn\" (click)=\"isClicked()\" (mouseenter)=\"mouseEnter()\" (mouseleave)=\"mouseLeave()\"\n  [ngClass]=\"btnClasses()\"\n  (mousedown)=\"mousedown()\" (mouseup)=\"mouseup()\">\n    <ng-container *ngTemplateOutlet=\"mycontent\"></ng-container>\n  </a>\n</ng-container>\n\n<ng-template #mycontent>\n  <ng-content></ng-content>\n</ng-template>\n", styles: [""] }]
    }], function () { return [{ type: i1.MaterialgrammiService }]; }, { clicked: [{
            type: Output
        }], taskType: [{
            type: Input
        }], btnStyle: [{
            type: Input
        }], task: [{
            type: Input
        }], target: [{
            type: Input
        }], theme: [{
            type: Input
        }], class: [{
            type: Input
        }], btnSize: [{
            type: Input
        }], isBlock: [{
            type: Input
        }], round: [{
            type: Input
        }], allowMargin: [{
            type: Input
        }], link: [{
            type: Input
        }], allowShrink: [{
            type: Input
        }], options: [{
            type: Input
        }], isExternalLink: [{
            type: Input
        }], newTab: [{
            type: Input
        }], active: [{
            type: Output
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL21hdGVyaWFsZ3JhbW1pL3NyYy9saWIvY29tcG9uZW50cy9idXR0b24vYnV0dG9uLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL21hdGVyaWFsZ3JhbW1pL3NyYy9saWIvY29tcG9uZW50cy9idXR0b24vYnV0dG9uLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7OztJQ0kzRSx3QkFBMkQ7Ozs7SUFKL0QsNkJBQStDO0lBQzdDLDRCQUVnRDtJQUZqQyxnS0FBUyxrQkFBVyxJQUFDLDZKQUFlLG1CQUFZLElBQTNCLDZKQUEyQyxtQkFBWSxJQUF2RCw0SkFFdkIsbUJBQVcsSUFGWSx3SkFFQyxpQkFBUyxJQUZWO0lBR2xDLGlHQUEyRDtJQUM3RCxpQkFBSTtJQUNOLDBCQUFlOzs7O0lBSmIsZUFBd0I7SUFBeEIsNkNBQXdCLHdDQUFBLDhDQUFBO0lBRVAsZUFBMkI7SUFBM0Isc0NBQTJCOzs7SUFRMUMsd0JBQTJEOzs7O0lBSi9ELDZCQUErQztJQUM3Qyw0QkFFZ0Q7SUFGakMsa0tBQVMsbUJBQVcsSUFBQywrSkFBZSxvQkFBWSxJQUEzQiwrSkFDdEIsb0JBQVksSUFEVSw2SkFFdkIsbUJBQVcsSUFGWSx5SkFFQyxpQkFBUyxJQUZWO0lBR2xDLGlHQUEyRDtJQUM3RCxpQkFBSTtJQUNOLDBCQUFlOzs7O0lBSmUsZUFBd0I7SUFBeEIsNkNBQXdCLDRCQUFBO0lBRW5DLGVBQTJCO0lBQTNCLHNDQUEyQjs7O0lBUTFDLHdCQUEyRDs7OztJQUovRCw2QkFBNkM7SUFDM0MsNEJBRWdEO0lBRmpDLGtLQUFTLG1CQUFXLElBQUMsK0pBQWUsb0JBQVksSUFB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RFI5QixlQUFlO2NBTDNCLFNBQVM7MkJBQ0UsV0FBVzt3RUFLWCxPQUFPO2tCQUFoQixNQUFNO1lBQ0UsUUFBUTtrQkFBaEIsS0FBSztZQUNHLFFBQVE7a0JBQWhCLEtBQUs7WUFDRyxJQUFJO2tCQUFaLEtBQUs7WUFDRyxNQUFNO2tCQUFkLEtBQUs7WUFDRyxLQUFLO2tCQUFiLEtBQUs7WUFDRyxLQUFLO2tCQUFiLEtBQUs7WUFDRyxPQUFPO2tCQUFmLEtBQUs7WUFDRyxPQUFPO2tCQUFmLEtBQUs7WUFDRyxLQUFLO2tCQUFiLEtBQUs7WUFDRyxXQUFXO2tCQUFuQixLQUFLO1lBQ0csSUFBSTtrQkFBWixLQUFLO1lBQ0csV0FBVztrQkFBbkIsS0FBSztZQUNHLE9BQU87a0JBQWYsS0FBSztZQUdHLGNBQWM7a0JBQXRCLEtBQUs7WUFDRyxNQUFNO2tCQUFkLEtBQUs7WUFFSSxNQUFNO2tCQUFmLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXRlcmlhbGdyYW1taVNlcnZpY2UgfSBmcm9tICcuLi8uLi9tYXRlcmlhbGdyYW1taS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbWctYnV0dG9uJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2J1dHRvbi5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2J1dHRvbi5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgQnV0dG9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQE91dHB1dCgpIGNsaWNrZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBJbnB1dCgpIHRhc2tUeXBlID0gXCJub25lXCI7XG4gIEBJbnB1dCgpIGJ0blN0eWxlID0gXCJzb2xpZFwiO1xuICBASW5wdXQoKSB0YXNrID0gXCJvcGVuXCI7XG4gIEBJbnB1dCgpIHRhcmdldDogYW55ID0gXCIvXCI7XG4gIEBJbnB1dCgpIHRoZW1lID0gXCJkZWZhdWx0XCI7XG4gIEBJbnB1dCgpIGNsYXNzID0gXCJcIjtcbiAgQElucHV0KCkgYnRuU2l6ZSA9IFwibWRcIjtcbiAgQElucHV0KCkgaXNCbG9jayA9IGZhbHNlO1xuICBASW5wdXQoKSByb3VuZCA9IGZhbHNlO1xuICBASW5wdXQoKSBhbGxvd01hcmdpbiA9IHRydWU7XG4gIEBJbnB1dCgpIGxpbmsgPSBcIlwiO1xuICBASW5wdXQoKSBhbGxvd1NocmluayA9IHRydWU7XG4gIEBJbnB1dCgpIG9wdGlvbnM6IGFueSA9IHt9O1xuXG5cbiAgQElucHV0KCkgaXNFeHRlcm5hbExpbmsgPSBmYWxzZTtcbiAgQElucHV0KCkgbmV3VGFiID0gZmFsc2U7XG5cbiAgQE91dHB1dCgpIGFjdGl2ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICByb3V0ZSA9IFtcIlwiXTtcbiAgYnV0dG9uVHlwZSA9IFwibm9uZVwiO1xuICBidXR0b25DbGFzc2VzID0gXCJcIjtcbiAgc2hyaW5rID0gZmFsc2U7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc2VydmljZTogTWF0ZXJpYWxncmFtbWlTZXJ2aWNlKSB7IH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcblxuICAgIGlmICh0aGlzLnRhc2tUeXBlICE9IFwibGlua1wiKSB7XG4gICAgICB0aGlzLnJvdXRlID0gW1wiXCJdO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJvdXRlID0gdGhpcy50YXJnZXQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNFeHRlcm5hbExpbmsgJiYgdGhpcy50YXNrVHlwZSA9PSBcImxpbmtcIikge1xuICAgICAgdGhpcy5idXR0b25UeXBlID0gXCJleHRlcm5hbFwiO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNFeHRlcm5hbExpbmsgJiYgdGhpcy50YXNrVHlwZSA9PSBcImxpbmtcIikge1xuICAgICAgdGhpcy5idXR0b25UeXBlID0gXCJpbnRlcm5hbFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJ1dHRvblR5cGUgPSBcIndpZGdldFwiO1xuICAgIH1cblxuICB9XG5cbiAgaXNDbGlja2VkKCkge1xuICAgIHRoaXMuY2xpY2tlZC5lbWl0KHRydWUpO1xuICAgIGlmICh0aGlzLnRhc2tUeXBlID09IFwibW9kYWxcIikge1xuICAgICAgdGhpcy5tb2RhbCgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50YXNrVHlwZSA9PSBcIm9mZkNhbnZhc1wiKSB7XG4gICAgICB0aGlzLm9mZkNhbnZhcygpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50YXNrVHlwZSA9PSBcInNsaWRlU2hvd1wiKSB7XG4gICAgICB0aGlzLnNsaWRlU2hvdygpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50YXNrVHlwZSA9PSBcIndpemFyZFwiKSB7XG4gICAgICB0aGlzLndpemFyZCgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50YXNrVHlwZSA9PSBcImNvbGxhcHNlXCIpIHtcbiAgICAgIHRoaXMuY29sbGFwc2UoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudGFza1R5cGUgPT0gXCJvdmVybGF5XCIpIHtcbiAgICAgIHRoaXMub3ZlcmxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGJ0bkNsYXNzZXMoKSB7XG4gICAgdGhpcy5idXR0b25DbGFzc2VzID0gdGhpcy5jbGFzcyArIFwiIFwiICsgdGhpcy50aGVtZTtcblxuICAgIHRoaXMuYnV0dG9uQ2xhc3NlcyArPSBgICR7dGhpcy5idG5TaXplfWA7XG5cbiAgICB0aGlzLmJ1dHRvbkNsYXNzZXMgKz0gdGhpcy5zaHJpbmsgPyBcIiBzaHJpbmtcIiA6IFwiXCJcblxuICAgIHRoaXMuYnV0dG9uQ2xhc3NlcyArPSB0aGlzLmlzQmxvY2sgPyBgIGJ0bi1ibG9ja2AgOiBgYDtcblxuICAgIHRoaXMuYnV0dG9uQ2xhc3NlcyArPSB0aGlzLmJ0blN0eWxlID09IFwibGlua1wiID8gXCIgbGlua1wiIDogKHRoaXMuYnRuU3R5bGUgPT0gXCJvdXRsaW5lXCIgPyBcIiBidG4tb3V0bGluZVwiIDogXCJcIik7XG5cbiAgICB0aGlzLmJ1dHRvbkNsYXNzZXMgKz0gdGhpcy5yb3VuZCA/IFwiIHJhZGl1cy01XCIgOiBcIlwiO1xuICAgIHRoaXMuYnV0dG9uQ2xhc3NlcyArPSB0aGlzLmFsbG93TWFyZ2luID8gXCIgbWFyZ2luUi01XCIgOiBcIlwiO1xuXG4gICAgcmV0dXJuIHRoaXMuYnV0dG9uQ2xhc3NlcztcbiAgfVxuXG4gIGNvbGxhcHNlKCkge1xuICAgIGlmICh0aGlzLnRhc2sgPT0gXCJvcGVuXCIpIHtcbiAgICAgIHRoaXMuc2VydmljZS5vcGVuQ29sbGFwc2UodGhpcy50YXJnZXQpO1xuICAgICAgdGhpcy5hY3RpdmUuZW1pdCh0cnVlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudGFzayA9PSBcImNsb3NlXCIpIHtcbiAgICAgIHRoaXMuc2VydmljZS5jbG9zZUNvbGxhcHNlKHRoaXMudGFyZ2V0KTtcbiAgICAgIHRoaXMuYWN0aXZlLmVtaXQoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIHdpemFyZCgpIHtcbiAgICBpZiAodGhpcy50YXNrID09IFwibmV4dFwiKSB7XG4gICAgICB0aGlzLmJ1dHRvbkNsYXNzZXMgKz0gdGhpcy5vcHRpb25zLm5leHQgJiYgIXRoaXMuYnV0dG9uQ2xhc3Nlcy5pbmNsdWRlcyhcImRpc2FibGVcIikgPyBcIiBkaXNhYmxlXCIgOiBcIlwiO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5uZXh0KSB7XG4gICAgICAgIHRoaXMuc2VydmljZS53aXphcmROZXh0U3RlcCh0aGlzLnRhcmdldCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLnRhc2sgPT0gXCJwcmV2aW91c1wiKSB7XG4gICAgICB0aGlzLmJ1dHRvbkNsYXNzZXMgKz0gdGhpcy5vcHRpb25zLnByZXZpb3VzICYmICF0aGlzLmJ1dHRvbkNsYXNzZXMuaW5jbHVkZXMoXCJkaXNhYmxlXCIpID8gXCIgZGlzYWJsZVwiIDogXCJcIjtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJldmlvdXMpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLldpemFyZFByZXZpb3VzU3RlcCh0aGlzLnRhcmdldCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbW91c2VFbnRlcigpIHtcbiAgICBpZiAodGhpcy50YXNrVHlwZSA9PSBcImRyb3Bkb3duXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwidG8gdHJpZ2dlciBkcm9wZG93blwiKTtcbiAgICAgIHRoaXMuc2VydmljZS5vcGVuRHJvcERvd24odGhpcy50YXJnZXQpO1xuICAgIH1cbiAgfVxuXG4gIG1vdXNlTGVhdmUoKSB7XG4gICAgdGhpcy5tb3VzZXVwKCk7XG4gICAgaWYgKHRoaXMudGFza1R5cGUgPT0gXCJkcm9wZG93blwiKSB7XG4gICAgICB0aGlzLnNlcnZpY2UuY2xvc2VEcm9wRG93bih0aGlzLnRhcmdldCk7XG4gICAgfVxuICB9XG5cbiAgc2xpZGVTaG93KCkge1xuICAgIGlmICh0aGlzLnRhc2sgPT0gXCJwbGF5XCIpIHtcbiAgICAgIC8vIHRoaXMuc2xpZGVTaG93U2VydmljZS5wbGF5KHRoaXMudGFyZ2V0KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudGFzayA9PSBcIm5leHRcIikge1xuICAgICAgLy8gdGhpcy5zbGlkZVNob3dTZXJ2aWNlLm5leHQodGhpcy50YXJnZXQpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50YXNrID09IFwicHJldmlvdXNcIikge1xuICAgICAgLy8gdGhpcy5zbGlkZVNob3dTZXJ2aWNlLnByZXZpb3VzKHRoaXMudGFyZ2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gdGhpcy5zbGlkZVNob3dTZXJ2aWNlLnBhdXNlKHRoaXMudGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICBtb2RhbCgpIHtcbiAgICBpZiAodGhpcy50YXNrID09IFwib3BlblwiKSB7XG4gICAgICB0aGlzLnNlcnZpY2Uub3Blbk1vZGFsKHRoaXMudGFyZ2V0KTtcbiAgICAgIHRoaXMuYWN0aXZlLmVtaXQodHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VydmljZS5jbG9zZU1vZGFsKHRoaXMudGFyZ2V0KTtcbiAgICAgIHRoaXMuYWN0aXZlLmVtaXQoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIG92ZXJsYXkoKSB7XG4gICAgaWYgKHRoaXMudGFzayA9PSBcIm9wZW5cIikge1xuICAgICAgY29uc29sZS5sb2coXCJvcGVuaW5nIHRhcmdldFwiLCB0aGlzLnRhcmdldCk7XG4gICAgICB0aGlzLnNlcnZpY2Uub3Blbk92ZXJsYXkodGhpcy50YXJnZXQpO1xuICAgICAgdGhpcy5hY3RpdmUuZW1pdCh0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXJ2aWNlLmNsb3NlT3ZlcmxheSh0aGlzLnRhcmdldCk7XG4gICAgICB0aGlzLmFjdGl2ZS5lbWl0KGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBvZmZDYW52YXMoKSB7XG4gICAgY29uc29sZS5sb2coXCJUYXNrIHR5cGUgaXMgb2ZmY2FudmFzXCIpO1xuICAgIGlmICh0aGlzLnRhc2sgPT0gXCJvcGVuXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwib3BlbmluZyB0YXJnZXRcIiwgdGhpcy50YXJnZXQpO1xuICAgICAgdGhpcy5zZXJ2aWNlLm9wZW5DYW52YXModGhpcy50YXJnZXQpO1xuICAgICAgdGhpcy5hY3RpdmUuZW1pdCh0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJDbG9zaW5nIHRoZSBjYW52YXNcIik7XG4gICAgICB0aGlzLnNlcnZpY2UuY2xvc2VDYW52YXModGhpcy50YXJnZXQpO1xuICAgICAgdGhpcy5hY3RpdmUuZW1pdChmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgbW91c2Vkb3duKCkge1xuICAgIGlmICh0aGlzLmFsbG93U2hyaW5rKSB7XG4gICAgICB0aGlzLnNocmluayA9IHRydWU7XG4gICAgfVxuXG4gIH1cblxuICBtb3VzZXVwKCkge1xuICAgIGlmICh0aGlzLmFsbG93U2hyaW5rKSB7XG4gICAgICB0aGlzLnNocmluayA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwiYnV0dG9uVHlwZSA9PSAnZXh0ZXJuYWwnXCI+XG4gIDxhIGNsYXNzPVwiYnRuXCIgKGNsaWNrKT1cImlzQ2xpY2tlZCgpXCIgKG1vdXNlZW50ZXIpPVwibW91c2VFbnRlcigpXCIgKG1vdXNlbGVhdmUpPVwibW91c2VMZWF2ZSgpXCJcbiAgW25nQ2xhc3NdPVwiYnRuQ2xhc3NlcygpXCIgW2hyZWZdPVwicm91dGVcIiBbdGFyZ2V0XT1cIm5ld1RhYiA/ICdfYmxhbmsnIDogJ19zZWxmJ1wiXG4gIChtb3VzZWRvd24pPVwibW91c2Vkb3duKClcIiAobW91c2V1cCk9XCJtb3VzZXVwKClcIj5cbiAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwibXljb250ZW50XCI+PC9uZy1jb250YWluZXI+XG4gIDwvYT5cbjwvbmctY29udGFpbmVyPlxuXG48bmctY29udGFpbmVyICpuZ0lmPVwiYnV0dG9uVHlwZSA9PSAnaW50ZXJuYWwnXCI+XG4gIDxhIGNsYXNzPVwiYnRuXCIgKGNsaWNrKT1cImlzQ2xpY2tlZCgpXCIgKG1vdXNlZW50ZXIpPVwibW91c2VFbnRlcigpXCJcbiAgKG1vdXNlbGVhdmUpPVwibW91c2VMZWF2ZSgpXCIgW25nQ2xhc3NdPVwiYnRuQ2xhc3NlcygpXCIgW3JvdXRlckxpbmtdPVwicm91dGVcIlxuICAobW91c2Vkb3duKT1cIm1vdXNlZG93bigpXCIgKG1vdXNldXApPVwibW91c2V1cCgpXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm15Y29udGVudFwiPjwvbmctY29udGFpbmVyPlxuICA8L2E+XG48L25nLWNvbnRhaW5lcj5cblxuPG5nLWNvbnRhaW5lciAqbmdJZj1cImJ1dHRvblR5cGUgPT0gJ3dpZGdldCdcIj5cbiAgPGEgY2xhc3M9XCJidG5cIiAoY2xpY2spPVwiaXNDbGlja2VkKClcIiAobW91c2VlbnRlcik9XCJtb3VzZUVudGVyKClcIiAobW91c2VsZWF2ZSk9XCJtb3VzZUxlYXZlKClcIlxuICBbbmdDbGFzc109XCJidG5DbGFzc2VzKClcIlxuICAobW91c2Vkb3duKT1cIm1vdXNlZG93bigpXCIgKG1vdXNldXApPVwibW91c2V1cCgpXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm15Y29udGVudFwiPjwvbmctY29udGFpbmVyPlxuICA8L2E+XG48L25nLWNvbnRhaW5lcj5cblxuPG5nLXRlbXBsYXRlICNteWNvbnRlbnQ+XG4gIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbjwvbmctdGVtcGxhdGU+XG4iXX0=