import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import * as i0 from "@angular/core";
;
;
;
;
export class MaterialgrammiService {
    constructor() {
        this.widgets = [];
        this.collapse = [];
        this.dropdown = [];
        this.megamenu = [];
        this.modal = [];
        this.overlay = [];
        this.wizard = [];
        this.slideshow = [];
        this.offcanvas = [];
        this.tab = [];
    }
    makeid(length, str) {
        str = typeof str == "string" ? str.split(" ").join("") : str;
        var result = '';
        var characters = 'ABCDEFGHIJKLMNOP+QRSTUVWXYZabcdefgh_ijklmnopqrst=uvwxyz0123456789-';
        var charactersLength = characters.length;
        for (var i = 0; i < length; i++) {
            result += characters.charAt(Math.floor(Math.random() *
                charactersLength));
        }
        return result + '-' + str;
    }
    registerTab(id, components, active) {
        this.tab[id] = {
            components,
            active: new BehaviorSubject(active)
        };
        for (let i = 0; i < components.length; i++) {
            this.registerWidget(components[i], "tab", id);
        }
        this.openTab(id, components[0]);
    }
    openTab(id, component_id) {
        this.closeAllTab(id);
        this.openWidget(component_id, "tab", id);
        this.tab[id].active.next(component_id);
    }
    closeAllTab(id) {
        if (this.tab && this.tab[id]) {
            for (let i = 0; i < this.tab[id].components.length; i++) {
                this.closeWidget(this.tab[id].components[i], "tab", id);
            }
        }
    }
    watchTab(id) {
        return this.tab[id].active.asObservable();
    }
    registerOffCanvas(id, status) {
        this.offcanvas[id] = {
            id,
            status: new BehaviorSubject(status)
        };
    }
    openCanvas(id) {
        this.offcanvas[id].status.next(true);
    }
    closeCanvas(id) {
        console.log("ID to be closed? ", id, "canvas ==> ", this.offcanvas[id]);
        this.offcanvas[id].status.next(false);
    }
    watchCanvas(id) {
        return this.offcanvas[id].status.asObservable();
    }
    registerSlideshow(id, activePage, play, next, previous, playInterval, timer) {
        var obj = {
            id,
            playInterval,
            timer,
            next: new BehaviorSubject(next),
            previous: new BehaviorSubject(previous),
            active: new BehaviorSubject(activePage),
            play: new BehaviorSubject(play)
        };
        this.slideshow[id] = obj;
    }
    watchSlideshowPlay(id) {
        return this.slideshow[id].play.asObservable();
    }
    watchSlideshowNext(id) {
        return this.slideshow[id].next.asObservable();
    }
    watchSlideshowPrevious(id) {
        return this.slideshow[id].previous.asObservable();
    }
    watchSlideshowActivePage(id) {
        return this.slideshow[id].active.asObservable();
    }
    nextSlide(id) {
        this.slideshow[id].next.next(true);
    }
    previousSlide(id) {
        this.slideshow[id].previous.next(true);
    }
    changeSlidePlay(id, play) {
        this.slideshow[id].play.next(play);
    }
    changeSlideActivePage(id, activePage) {
        this.slideshow[id].active.next(activePage);
    }
    playSlideShow(id) {
        var selected = this.slideshow[id];
        if (selected) {
            if (selected.playInterval) {
                this.pauseSlideshow(id);
            }
            selected.play.next(true);
            var _this = this;
            this.nextSlide(id);
            selected.playInterval = setInterval(() => {
                _this.nextSlide(id);
            }, selected.timer);
        }
    }
    pauseSlideshow(id) {
        var selected = this.slideshow[id];
        if (selected && selected.playInterval) {
            clearInterval(selected.playInterval);
            selected.playInterval = false;
        }
    }
    registerWizard(wizardId, components, active = 0) {
        let next = {};
        let prev = {};
        if (components[active]) {
            next = {
                index: components && components[active + 1] ? active + 1 : active,
                id: components && components[active + 1] ? components[active + 1] : components[active]
            };
            prev = {
                index: components && components[active - 1] ? active - 1 : active,
                id: components && components[active - 1] ? components[active - 1] : components[active]
            };
        }
        else {
            // defaults
            active = 0;
            next = {
                index: components && components[1] ? 1 : 0,
                id: components && components[1] ? components[1] : components[0]
            };
            prev = {
                index: 0,
                id: components[0]
            };
        }
        this.wizard[wizardId] = {
            active: new BehaviorSubject(0),
            on: active,
            completed: new BehaviorSubject(false),
            next,
            prev,
            components
        };
        for (let i = 0; i < components.length; i++) {
            this.registerWidget(components[i], "wizard", wizardId);
        }
        this.openWidget(components[0], "wizard", wizardId);
    }
    wizardNextStep(wizardId) {
        let activateIndex = this.wizard[wizardId].on + 1;
        this.activateWizardStep(wizardId, activateIndex);
    }
    WizardPreviousStep(wizardId) {
        let activateIndex = this.wizard[wizardId].on - 1;
        this.activateWizardStep(wizardId, activateIndex);
    }
    WizardCloseAll(wizardId) {
        if (this.wizard[wizardId] && this.wizard[wizardId].components) {
            for (let i = 0; i < this.wizard[wizardId].components.length; i++) {
                this.closeWidget(this.wizard[wizardId].components[i], "wizard", wizardId);
            }
        }
    }
    activateWizardStep(wizardId, index) {
        if (this.wizard[wizardId].components[index]) {
            if (index >= this.wizard[wizardId].components.length - 1) {
                this.isWizardComplete(wizardId);
            }
            else {
                this.isWizardNotComplete(wizardId);
            }
            this.wizard[wizardId].on = index;
            this.wizard[wizardId].prev.index = this.wizard[wizardId].components[index - 1] ? index - 1 : index;
            this.wizard[wizardId].next.index = this.wizard[wizardId].components[index + 1] ? index + 1 : index;
            this.wizard[wizardId].prev.id = this.wizard[wizardId].components[index - 1] ?
                this.wizard[wizardId].components[index - 1] : this.wizard[wizardId].components[index];
            this.wizard[wizardId].next.id = this.wizard[wizardId].components[index + 1] ?
                this.wizard[wizardId].components[index + 1] : this.wizard[wizardId].components[index];
            ;
            this.WizardCloseAll(wizardId);
            this.openWidget(this.wizard[wizardId].components[index], "wizard", wizardId);
            this.watchWidget(this.wizard[wizardId].components[index], "wizard", wizardId).subscribe((data) => {
                if (data) {
                    this.wizard[wizardId].active.next(index);
                }
            });
        }
    }
    isWizardComplete(wizardId) {
        this.wizard[wizardId].completed.next(true);
    }
    isWizardNotComplete(wizardId) {
        this.wizard[wizardId].completed.next(false);
    }
    watchWizardActive(wizardId) {
        return this.wizard[wizardId].active.asObservable();
    }
    watchWizardCompleted(wizardId) {
        return this.wizard[wizardId].completed.asObservable();
    }
    registerOverlay(id, status) {
        this.overlay[id] = {
            id,
            status: new BehaviorSubject(status)
        };
    }
    openOverlay(id) {
        console.log("Overlay?", this.overlay);
        this.overlay[id].status.next(true);
    }
    closeOverlay(id) {
        this.overlay[id].status.next(false);
    }
    watchOverlay(id) {
        return this.overlay[id].status.asObservable();
    }
    registerModal(id, status) {
        this.modal[id] = {
            id,
            status: new BehaviorSubject(status)
        };
    }
    openModal(id) {
        this.modal[id].status.next(true);
    }
    closeModal(id) {
        this.modal[id].status.next(false);
    }
    watchModal(id) {
        return this.modal[id].status.asObservable();
    }
    registerDropDown(id, status) {
        this.dropdown[id] = {
            id,
            status: new BehaviorSubject(status)
        };
    }
    openDropDown(id) {
        this.dropdown[id].status.next(true);
    }
    closeDropDown(id) {
        this.dropdown[id].status.next(false);
    }
    watchDropDown(id) {
        return this.dropdown[id].status.asObservable();
    }
    registerCollapse(id, status) {
        this.collapse[id] = {
            id,
            status: new BehaviorSubject(status)
        };
    }
    openCollapse(id) {
        this.collapse[id].status.next(true);
    }
    closeCollapse(id) {
        this.collapse[id].status.next(false);
    }
    watchCollapse(id) {
        return this.collapse[id].status.asObservable();
    }
    getWidgetId(id, type, parent_id) {
        return id + '_' + type + '_' + parent_id;
    }
    widgetExists(id, parent_type, parent_id) {
        return this.widgets[this.getWidgetId(id, parent_type, parent_id)] ? true : false;
    }
    registerWidget(id, parent_type, parent_id, options = {}) {
        let mywidgetid = this.getWidgetId(id, parent_type, parent_id);
        this.widgets[mywidgetid] = {
            id,
            type: parent_type,
            parent_id: parent_id,
            options: new BehaviorSubject(options),
            status: new BehaviorSubject(false)
        };
    }
    openWidget(id, parent_type, parent_id) {
        let mywidgetid = this.getWidgetId(id, parent_type, parent_id);
        if (this.widgets && this.widgets[mywidgetid]) {
            this.widgets[mywidgetid].status.next(true);
        }
    }
    closeWidget(id, parent_type, parent_id) {
        let mywidgetid = this.getWidgetId(id, parent_type, parent_id);
        if (this.widgets && this.widgets[mywidgetid]) {
            this.widgets[mywidgetid].status.next(false);
        }
    }
    closeAllParentWidgets(parent_type, parent_id) {
        let allWidgetIds = Object.keys(this.widgets);
        for (let i = 0; i < allWidgetIds.length; i++) {
            if (this.widgets[allWidgetIds[i]].type == parent_type && this.widgets[allWidgetIds[i]].parent_id == parent_id) {
                this.closeWidget(this.widgets[allWidgetIds[i]].id, parent_type, parent_id);
            }
        }
    }
    watchWidget(id, parent_type, parent_id) {
        return this.widgets[this.getWidgetId(id, parent_type, parent_id)].status.asObservable();
    }
    watchOptions(id, parent_type, parent_id) {
        return this.widgets[this.getWidgetId(id, parent_type, parent_id)].options.asObservable();
    }
    registerMegaMenu(id, links) {
        this.megamenu[id] = {
            id,
            active: new BehaviorSubject("")
        };
        for (let i = 0; i < links.length; i++) {
            this.registerWidget(links[i], "megamenu", id);
        }
    }
    watchMegaMenu(id) {
        return this.megamenu[id].active.asObservable();
    }
    openMegaMenu(id, targetid) {
        this.megamenu[id].active.next(targetid);
        if (this.widgetExists(targetid, "megamenu", id)) {
            this.closeMegaMenu(id);
            this.openWidget(targetid, "megamenu", id);
        }
    }
    closeMegaMenu(id) {
        this.closeAllParentWidgets("megamenu", id);
        this.megamenu[id].active.next(false);
    }
    fallbackCopyTextToClipboard(text) {
        var textArea = document.createElement("textarea");
        textArea.value = text;
        // Avoid scrolling to bottom
        textArea.style.top = "0";
        textArea.style.left = "0";
        textArea.style.position = "fixed";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
            var successful = document.execCommand('copy');
            var msg = successful ? 'successful' : 'unsuccessful';
            console.log('Fallback: Copying text command was ' + msg);
        }
        catch (err) {
            console.error('Fallback: Oops, unable to copy', err);
        }
        document.body.removeChild(textArea);
    }
    copyToClipboard(text) {
        if (!navigator.clipboard) {
            this.fallbackCopyTextToClipboard(text);
            return;
        }
        navigator.clipboard.writeText(text).then(function () {
            console.log('Async: Copying to clipboard was successful!');
        }, function (err) {
            console.error('Async: Could not copy text: ', err);
        });
    }
}
MaterialgrammiService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: MaterialgrammiService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
MaterialgrammiService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: MaterialgrammiService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: MaterialgrammiService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return []; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0ZXJpYWxncmFtbWkuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL21hdGVyaWFsZ3JhbW1pL3NyYy9saWIvbWF0ZXJpYWxncmFtbWkuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxlQUFlLEVBQXVCLE1BQU0sTUFBTSxDQUFDOztBQU8zRCxDQUFDO0FBS0QsQ0FBQztBQU1ELENBQUM7QUEyQ0QsQ0FBQztBQXlCRixNQUFNLE9BQU8scUJBQXFCO0lBYWhDO1FBWFEsWUFBTyxHQUFtQixFQUFFLENBQUM7UUFDN0IsYUFBUSxHQUFxQixFQUFFLENBQUM7UUFDaEMsYUFBUSxHQUFxQixFQUFFLENBQUM7UUFDaEMsYUFBUSxHQUFxQixFQUFFLENBQUM7UUFDaEMsVUFBSyxHQUFrQixFQUFFLENBQUM7UUFDMUIsWUFBTyxHQUFvQixFQUFFLENBQUM7UUFDOUIsV0FBTSxHQUFtQixFQUFFLENBQUM7UUFDNUIsY0FBUyxHQUFzQixFQUFFLENBQUM7UUFDbEMsY0FBUyxHQUFzQixFQUFFLENBQUM7UUFDbEMsUUFBRyxHQUFnQixFQUFFLENBQUM7SUFFZCxDQUFDO0lBRWpCLE1BQU0sQ0FBQyxNQUFjLEVBQUUsR0FBb0I7UUFDekMsR0FBRyxHQUFHLE9BQU8sR0FBRyxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUM3RCxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7UUFDaEIsSUFBSSxVQUFVLEdBQUcsb0VBQW9FLENBQUM7UUFDdEYsSUFBSSxnQkFBZ0IsR0FBRyxVQUFVLENBQUMsTUFBTSxDQUFDO1FBQ3pDLEtBQUssSUFBSSxDQUFDLEdBQUcs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QUMsU0FBUyxDQUFDLFNBQVMsRUFBRTtZQUN4QixJQUFJLENBQUMsMkJBQTJCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsT0FBTztTQUNSO1FBQ0QsU0FBUyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNkNBQTZDLENBQUMsQ0FBQztRQUM3RCxDQUFDLEVBQUUsVUFBUyxHQUFHO1lBQ2IsT0FBTyxDQUFDLEtBQUssQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7O2tIQWxiVSxxQkFBcUI7c0hBQXJCLHFCQUFxQixjQUZwQixNQUFNOzJGQUVQLHFCQUFxQjtrQkFIakMsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuZXhwb3J0IGludGVyZmFjZSBXaWRnZXQge1xuICBpZDogc3RyaW5nLFxuICB0eXBlOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBCZWhhdmlvclN1YmplY3Q8YW55PixcbiAgc3RhdHVzOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj5cbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNjb3JkaW9uSXRlbSB7XG4gIC8vIHdpZGdldElkXG4gIGlkPzogc3RyaW5nXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEFjY29yZGlvbiB7XG4gIGlkOiBzdHJpbmcsXG4gIGl0ZW1zPzogW0FjY29yZGlvbkl0ZW1dLFxuICBhY3RpdmVJdGVtPzogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbGxhcHNlIHtcbiAgaWQ6IHN0cmluZyxcbiAgc3RhdHVzOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEcm9wZG93biB7XG4gIGlkOiBzdHJpbmcsXG4gIHN0YXR1czogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVnYU1lbnUge1xuICBpZDogc3RyaW5nLFxuICBhY3RpdmU6IEJlaGF2aW9yU3ViamVjdDxzdHJpbmcgfCBib29sZWFuPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGFsIHtcbiAgaWQ6IHN0cmluZyxcbiAgc3RhdHVzOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBPdmVybGF5IHtcbiAgaWQ6IHN0cmluZyxcbiAgc3RhdHVzOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj5cbn1cblxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2l6YXJkIHtcbiAgaWQ6IHN0cmluZyxcbiAgYWN0aXZlOiBCZWhhdmlvclN1YmplY3Q8bnVtYmVyPixcbiAgb246IG51bWJlcixcbiAgY29tcGxldGVkOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj4sXG4gIG5leHQ6IHtcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIGlkOiBzdHJpbmdcbiAgfSxcbiAgcHJldjoge1xuICAgIGluZGV4OiBudW1iZXIsXG4gICAgaWQ6IHN0cmluZ1xuICB9LFxuICBjb21wb25lbnRzOiBbc3RyaW5nXVxufTtcblxuZXhwb3J0IGludGVyZmFjZSBTbGlkZXNob3cge1xuICBpZDogc3RyaW5nLFxuICBwbGF5SW50ZXJ2YWw6IGFueSxcbiAgdGltZXI6IG51bWJlcixcbiAgbmV4dDogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+LFxuICBwcmV2aW91czogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+LFxuICBhY3RpdmU6IEJlaGF2aW9yU3ViamVjdDxudW1iZXI+LFxuICBwbGF5OiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBPZmZDYW52YXMge1xuICBpZDogc3RyaW5nLFxuICBzdGF0dXM6IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhYiB7XG4gIGFjdGl2ZTogQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4sXG4gIGNvbXBvbmVudHM6IFtzdHJpbmddXG59XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE1hdGVyaWFsZ3JhbW1pU2VydmljZSB7XG5cbiAgcHJpdmF0ZSB3aWRnZXRzOiBbV2lkZ2V0XSB8IGFueSA9IFtdO1xuICBwcml2YXRlIGNvbGxhcHNlOiBbQ29sbGFwc2VdIHwgYW55ID0gW107XG4gIHByaXZhdGUgZHJvcGRvd246IFtEcm9wZG93bl0gfCBhbnkgPSBbXTtcbiAgcHJpdmF0ZSBtZWdhbWVudTogW01lZ2FNZW51XSB8IGFueSA9IFtdO1xuICBwcml2YXRlIG1vZGFsOiBbTW9kYWxdIHwgYW55ID0gW107XG4gIHByaXZhdGUgb3ZlcmxheTogW092ZXJsYXldIHwgYW55ID0gW107XG4gIHByaXZhdGUgd2l6YXJkOiBbV2l6YXJkXSB8IGFueSA9IFtdO1xuICBwcml2YXRlIHNsaWRlc2hvdzogW1NsaWRlc2hvd10gfCBhbnkgPSBbXTtcbiAgcHJpdmF0ZSBvZmZjYW52YXM6IFtPZmZDYW52YXNdIHwgYW55ID0gW107XG4gIHByaXZhdGUgdGFiOiBbVGFiXSB8IGFueSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKCkgeyB9XG5cbiAgbWFrZWlkKGxlbmd0aDogbnVtYmVyLCBzdHI6IHN0cmluZyB8IG51bWJlcikge1xuICAgIHN0ciA9IHR5cGVvZiBzdHIgPT0gXCJzdHJpbmdcIiA/IHN0ci5zcGxpdChcIiBcIikuam9pbihcIlwiKSA6IHN0cjtcbiAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgdmFyIGNoYXJhY3RlcnMgPSAnQUJDREVGR0hJSktMTU5PUCtRUlNUVVZXWFlaYWJjZGVmZ2hfaWprbG1ub3BxcnN0PXV2d3h5ejAxMjM0NTY3ODktJztcbiAgICB2YXIgY2hhcmFjdGVyc0xlbmd0aCA9IGNoYXJhY3RlcnMubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdCArPSBjaGFyYWN0ZXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKlxuICAgICAgICBjaGFyYWN0ZXJzTGVuZ3RoKSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQgKyAnLScgKyBzdHI7XG4gIH1cblxuICByZWdpc3RlclRhYihpZDogc3RyaW5nLCBjb21wb25lbnRzOiBhbnksIGFjdGl2ZTogc3RyaW5nKSB7XG4gICAgdGhpcy50YWJbaWRdID0ge1xuICAgICAgY29tcG9uZW50cyxcbiAgICAgIGFjdGl2ZTogbmV3IEJlaGF2aW9yU3ViamVjdChhY3RpdmUpXG4gICAgfTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJXaWRnZXQoY29tcG9uZW50c1tpXSwgXCJ0YWJcIiwgaWQpO1xuICAgIH1cbiAgICB0aGlzLm9wZW5UYWIoaWQsIGNvbXBvbmVudHNbMF0pO1xuICB9XG5cbiAgb3BlblRhYihpZDogc3RyaW5nLCBjb21wb25lbnRfaWQ6IHN0cmluZykge1xuICAgIHRoaXMuY2xvc2VBbGxUYWIoaWQpO1xuICAgIHRoaXMub3BlbldpZGdldChjb21wb25lbnRfaWQsIFwidGFiXCIsIGlkKTtcbiAgICB0aGlzLnRhYltpZF0uYWN0aXZlLm5leHQoY29tcG9uZW50X2lkKTtcbiAgfVxuXG4gIGNsb3NlQWxsVGFiKGlkOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy50YWIgJiYgdGhpcy50YWJbaWRdKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGFiW2lkXS5jb21wb25lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuY2xvc2VXaWRnZXQodGhpcy50YWJbaWRdLmNvbXBvbmVudHNbaV0sIFwidGFiXCIsIGlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB3YXRjaFRhYihpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMudGFiW2lkXS5hY3RpdmUuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICByZWdpc3Rlck9mZkNhbnZhcyhpZDogc3RyaW5nLCBzdGF0dXM6IGJvb2xlYW4pIHtcbiAgICB0aGlzLm9mZmNhbnZhc1tpZF0gPSB7XG4gICAgICBpZCxcbiAgICAgIHN0YXR1czogbmV3IEJlaGF2aW9yU3ViamVjdChzdGF0dXMpXG4gICAgfTtcbiAgfVxuXG4gIG9wZW5DYW52YXMoaWQ6IHN0cmluZykge1xuICAgIHRoaXMub2ZmY2FudmFzW2lkXS5zdGF0dXMubmV4dCh0cnVlKTtcbiAgfVxuXG4gIGNsb3NlQ2FudmFzKGlkOiBzdHJpbmcpIHtcbiAgICBjb25zb2xlLmxvZyhcIklEIHRvIGJlIGNsb3NlZD8gXCIsIGlkLCBcImNhbnZhcyA9PT4gXCIsIHRoaXMub2ZmY2FudmFzW2lkXSk7XG4gICAgdGhpcy5vZmZjYW52YXNbaWRdLnN0YXR1cy5uZXh0KGZhbHNlKTtcbiAgfVxuXG4gIHdhdGNoQ2FudmFzKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5vZmZjYW52YXNbaWRdLnN0YXR1cy5hc09ic2VydmFibGUoKTtcbiAgfVxuXG5cbiAgcmVnaXN0ZXJTbGlkZXNob3coaWQ6IHN0cmluZywgYWN0aXZlUGFnZTogbnVtYmVyLCBwbGF5OiBib29sZWFuLCBuZXh0OiBib29sZWFuLCBwcmV2aW91czogYm9vbGVhbiwgcGxheUludGVydmFsOiBhbnksIHRpbWVyOiBudW1iZXIpIHtcbiAgICB2YXIgb2JqOiBhbnkgPSB7XG4gICAgICBpZCxcbiAgICAgIHBsYXlJbnRlcnZhbCxcbiAgICAgIHRpbWVyLFxuICAgICAgbmV4dDogbmV3IEJlaGF2aW9yU3ViamVjdChuZXh0KSxcbiAgICAgIHByZXZpb3VzOiBuZXcgQmVoYXZpb3JTdWJqZWN0KHByZXZpb3VzKSxcbiAgICAgIGFjdGl2ZTogbmV3IEJlaGF2aW9yU3ViamVjdChhY3RpdmVQYWdlKSxcbiAgICAgIHBsYXk6IG5ldyBCZWhhdmlvclN1YmplY3QocGxheSlcbiAgICB9O1xuICAgIHRoaXMuc2xpZGVzaG93W2lkXSA9IG9iajtcbiAgfVxuXG4gIHdhdGNoU2xpZGVzaG93UGxheShpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuc2xpZGVzaG93W2lkXS5wbGF5LmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgd2F0Y2hTbGlkZXNob3dOZXh0KGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5zbGlkZXNob3dbaWRdLm5leHQuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICB3YXRjaFNsaWRlc2hvd1ByZXZpb3VzKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5zbGlkZXNob3dbaWRdLnByZXZpb3VzLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgd2F0Y2hTbGlkZXNob3dBY3RpdmVQYWdlKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5zbGlkZXNob3dbaWRdLmFjdGl2ZS5hc09ic2VydmFibGUoKTtcbiAgfVxuXG4gIG5leHRTbGlkZShpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5zbGlkZXNob3dbaWRdLm5leHQubmV4dCh0cnVlKTtcbiAgfVxuXG4gIHByZXZpb3VzU2xpZGUoaWQ6IHN0cmluZykge1xuICAgIHRoaXMuc2xpZGVzaG93W2lkXS5wcmV2aW91cy5uZXh0KHRydWUpO1xuICB9XG5cbiAgY2hhbmdlU2xpZGVQbGF5KGlkOiBzdHJpbmcsIHBsYXk6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnNsaWRlc2hvd1tpZF0ucGxheS5uZXh0KHBsYXkpO1xuICB9XG5cbiAgY2hhbmdlU2xpZGVBY3RpdmVQYWdlKGlkOiBzdHJpbmcsIGFjdGl2ZVBhZ2U6IG51bWJlcikge1xuICAgIHRoaXMuc2xpZGVzaG93W2lkXS5hY3RpdmUubmV4dChhY3RpdmVQYWdlKTtcbiAgfVxuXG4gIHBsYXlTbGlkZVNob3coaWQ6IHN0cmluZykge1xuICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuc2xpZGVzaG93W2lkXTtcbiAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgIGlmIChzZWxlY3RlZC5wbGF5SW50ZXJ2YWwpIHtcbiAgICAgICAgdGhpcy5wYXVzZVNsaWRlc2hvdyhpZCk7XG4gICAgICB9XG4gICAgICBzZWxlY3RlZC5wbGF5Lm5leHQodHJ1ZSk7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdGhpcy5uZXh0U2xpZGUoaWQpO1xuICAgICAgc2VsZWN0ZWQucGxheUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBfdGhpcy5uZXh0U2xpZGUoaWQpO1xuICAgICAgfSwgc2VsZWN0ZWQudGltZXIpO1xuICAgIH1cbiAgfVxuXG4gIHBhdXNlU2xpZGVzaG93KGlkOiBzdHJpbmcpIHtcbiAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLnNsaWRlc2hvd1tpZF07XG4gICAgaWYgKHNlbGVjdGVkICYmIHNlbGVjdGVkLnBsYXlJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbChzZWxlY3RlZC5wbGF5SW50ZXJ2YWwpO1xuICAgICAgc2VsZWN0ZWQucGxheUludGVydmFsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJXaXphcmQod2l6YXJkSWQ6IHN0cmluZywgY29tcG9uZW50czogYW55LCBhY3RpdmUgPSAwKSB7XG4gICAgbGV0IG5leHQgPSB7fTtcbiAgICBsZXQgcHJldiA9IHt9O1xuICAgIGlmIChjb21wb25lbnRzW2FjdGl2ZV0pIHtcbiAgICAgIG5leHQgPSB7XG4gICAgICAgIGluZGV4OiBjb21wb25lbnRzICYmIGNvbXBvbmVudHNbYWN0aXZlICsgMV0gPyBhY3RpdmUgKyAxIDogYWN0aXZlLFxuICAgICAgICBpZDogY29tcG9uZW50cyAmJiBjb21wb25lbnRzW2FjdGl2ZSArIDFdID8gY29tcG9uZW50c1thY3RpdmUgKyAxXSA6IGNvbXBvbmVudHNbYWN0aXZlXVxuICAgICAgfTtcbiAgICAgIHByZXYgPSB7XG4gICAgICAgIGluZGV4OiBjb21wb25lbnRzICYmIGNvbXBvbmVudHNbYWN0aXZlIC0gMV0gPyBhY3RpdmUgLSAxIDogYWN0aXZlLFxuICAgICAgICBpZDogY29tcG9uZW50cyAmJiBjb21wb25lbnRzW2FjdGl2ZSAtIDFdID8gY29tcG9uZW50c1thY3RpdmUgLSAxXSA6IGNvbXBvbmVudHNbYWN0aXZlXVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZGVmYXVsdHNcbiAgICAgIGFjdGl2ZSA9IDA7XG4gICAgICBuZXh0ID0ge1xuICAgICAgICBpbmRleDogY29tcG9uZW50cyAmJiBjb21wb25lbnRzWzFdID8gMSA6IDAsXG4gICAgICAgIGlkOiBjb21wb25lbnRzICYmIGNvbXBvbmVudHNbMV0gPyBjb21wb25lbnRzWzFdIDogY29tcG9uZW50c1swXVxuICAgICAgfTtcbiAgICAgIHByZXYgPSB7XG4gICAgICAgIGluZGV4OiAwLFxuICAgICAgICBpZDogY29tcG9uZW50c1swXVxuICAgICAgfTtcbiAgICB9XG5cbiAgICB0aGlzLndpemFyZFt3aXphcmRJZF0gPSB7XG4gICAgICBhY3RpdmU6IG5ldyBCZWhhdmlvclN1YmplY3QoMCksXG4gICAgICBvbjogYWN0aXZlLFxuICAgICAgY29tcGxldGVkOiBuZXcgQmVoYXZpb3JTdWJqZWN0KGZhbHNlKSxcbiAgICAgIG5leHQsXG4gICAgICBwcmV2LFxuICAgICAgY29tcG9uZW50c1xuICAgIH07XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJXaWRnZXQoY29tcG9uZW50c1tpXSwgXCJ3aXphcmRcIiwgd2l6YXJkSWQpO1xuICAgIH1cblxuICAgIHRoaXMub3BlbldpZGdldChjb21wb25lbnRzWzBdLCBcIndpemFyZFwiLCB3aXphcmRJZCk7XG4gIH1cblxuICB3aXphcmROZXh0U3RlcCh3aXphcmRJZDogc3RyaW5nKSB7XG4gICAgbGV0IGFjdGl2YXRlSW5kZXggPSB0aGlzLndpemFyZFt3aXphcmRJZF0ub24gKyAxO1xuICAgIHRoaXMuYWN0aXZhdGVXaXphcmRTdGVwKHdpemFyZElkLCBhY3RpdmF0ZUluZGV4KTtcbiAgfVxuXG4gIFdpemFyZFByZXZpb3VzU3RlcCh3aXphcmRJZDogc3RyaW5nKSB7XG4gICAgbGV0IGFjdGl2YXRlSW5kZXggPSB0aGlzLndpemFyZFt3aXphcmRJZF0ub24gLSAxO1xuICAgIHRoaXMuYWN0aXZhdGVXaXphcmRTdGVwKHdpemFyZElkLCBhY3RpdmF0ZUluZGV4KTtcbiAgfVxuXG4gIFdpemFyZENsb3NlQWxsKHdpemFyZElkOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy53aXphcmRbd2l6YXJkSWRdICYmIHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuY2xvc2VXaWRnZXQodGhpcy53aXphcmRbd2l6YXJkSWRdLmNvbXBvbmVudHNbaV0sIFwid2l6YXJkXCIsIHdpemFyZElkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhY3RpdmF0ZVdpemFyZFN0ZXAod2l6YXJkSWQ6IHN0cmluZywgaW5kZXg6IG51bWJlcikge1xuXG4gICAgaWYgKHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzW2luZGV4XSkge1xuICAgICAgaWYoaW5kZXggPj0gdGhpcy53aXphcmRbd2l6YXJkSWRdLmNvbXBvbmVudHMubGVuZ3RoIC0xKXtcbiAgICAgICAgdGhpcy5pc1dpemFyZENvbXBsZXRlKHdpemFyZElkKTtcbiAgICAgIH1lbHNlIHtcbiAgICAgICAgdGhpcy5pc1dpemFyZE5vdENvbXBsZXRlKHdpemFyZElkKTtcbiAgICAgIH1cbiAgICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5vbiA9IGluZGV4O1xuICAgICAgdGhpcy53aXphcmRbd2l6YXJkSWRdLnByZXYuaW5kZXggPSB0aGlzLndpemFyZFt3aXphcmRJZF0uY29tcG9uZW50c1tpbmRleCAtIDFdID8gaW5kZXggLSAxIDogaW5kZXg7XG4gICAgICB0aGlzLndpemFyZFt3aXphcmRJZF0ubmV4dC5pbmRleCA9IHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzW2luZGV4ICsgMV0gPyBpbmRleCArIDEgOiBpbmRleDtcbiAgICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5wcmV2LmlkID0gdGhpcy53aXphcmRbd2l6YXJkSWRdLmNvbXBvbmVudHNbaW5kZXggLSAxXSA/XG4gICAgICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzW2luZGV4IC0gMV0gOiB0aGlzLndpemFyZFt3aXphcmRJZF0uY29tcG9uZW50c1tpbmRleF07XG4gICAgICB0aGlzLndpemFyZFt3aXphcmRJZF0ubmV4dC5pZCA9IHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzW2luZGV4ICsgMV0gP1xuICAgICAgICB0aGlzLndpemFyZFt3aXphcmRJZF0uY29tcG9uZW50c1tpbmRleCArIDFdIDogdGhpcy53aXphcmRbd2l6YXJkSWRdLmNvbXBvbmVudHNbaW5kZXhdOztcbiAgICAgIHRoaXMuV2l6YXJkQ2xvc2VBbGwod2l6YXJkSWQpO1xuICAgICAgdGhpcy5vcGVuV2lkZ2V0KHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wb25lbnRzW2luZGV4XSwgXCJ3aXphcmRcIiwgd2l6YXJkSWQpO1xuICAgICAgdGhpcy53YXRjaFdpZGdldCh0aGlzLndpemFyZFt3aXphcmRJZF0uY29tcG9uZW50c1tpbmRleF0sIFwid2l6YXJkXCIsIHdpemFyZElkKS5zdWJzY3JpYmUoKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5hY3RpdmUubmV4dChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlzV2l6YXJkQ29tcGxldGUod2l6YXJkSWQ6IHN0cmluZykge1xuICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wbGV0ZWQubmV4dCh0cnVlKTtcbiAgfVxuXG4gIGlzV2l6YXJkTm90Q29tcGxldGUod2l6YXJkSWQ6IHN0cmluZykge1xuICAgIHRoaXMud2l6YXJkW3dpemFyZElkXS5jb21wbGV0ZWQubmV4dChmYWxzZSk7XG4gIH1cblxuICB3YXRjaFdpemFyZEFjdGl2ZSh3aXphcmRJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICByZXR1cm4gdGhpcy53aXphcmRbd2l6YXJkSWRdLmFjdGl2ZS5hc09ic2VydmFibGUoKTtcbiAgfVxuXG4gIHdhdGNoV2l6YXJkQ29tcGxldGVkKHdpemFyZElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPHRydWUgfCBmYWxzZT4ge1xuICAgIHJldHVybiB0aGlzLndpemFyZFt3aXphcmRJZF0uY29tcGxldGVkLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cblxuICByZWdpc3Rlck92ZXJsYXkoaWQ6IHN0cmluZywgc3RhdHVzOiBib29sZWFuKSB7XG4gICAgdGhpcy5vdmVybGF5W2lkXSA9IHtcbiAgICAgIGlkLFxuICAgICAgc3RhdHVzOiBuZXcgQmVoYXZpb3JTdWJqZWN0KHN0YXR1cylcbiAgICB9O1xuICB9XG5cbiAgb3Blbk92ZXJsYXkoaWQ6IHN0cmluZykge1xuICAgIGNvbnNvbGUubG9nKFwiT3ZlcmxheT9cIiwgdGhpcy5vdmVybGF5KTtcbiAgICB0aGlzLm92ZXJsYXlbaWRdLnN0YXR1cy5uZXh0KHRydWUpO1xuICB9XG5cbiAgY2xvc2VPdmVybGF5KGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLm92ZXJsYXlbaWRdLnN0YXR1cy5uZXh0KGZhbHNlKTtcbiAgfVxuXG4gIHdhdGNoT3ZlcmxheShpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMub3ZlcmxheVtpZF0uc3RhdHVzLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgcmVnaXN0ZXJNb2RhbChpZDogc3RyaW5nLCBzdGF0dXM6IGJvb2xlYW4pIHtcbiAgICB0aGlzLm1vZGFsW2lkXSA9IHtcbiAgICAgIGlkLFxuICAgICAgc3RhdHVzOiBuZXcgQmVoYXZpb3JTdWJqZWN0KHN0YXR1cylcbiAgICB9O1xuICB9XG5cbiAgb3Blbk1vZGFsKGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLm1vZGFsW2lkXS5zdGF0dXMubmV4dCh0cnVlKTtcbiAgfVxuXG4gIGNsb3NlTW9kYWwoaWQ6IHN0cmluZykge1xuICAgIHRoaXMubW9kYWxbaWRdLnN0YXR1cy5uZXh0KGZhbHNlKTtcbiAgfVxuXG4gIHdhdGNoTW9kYWwoaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLm1vZGFsW2lkXS5zdGF0dXMuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICByZWdpc3RlckRyb3BEb3duKGlkOiBzdHJpbmcsIHN0YXR1czogYm9vbGVhbikge1xuICAgIHRoaXMuZHJvcGRvd25baWRdID0ge1xuICAgICAgaWQsXG4gICAgICBzdGF0dXM6IG5ldyBCZWhhdmlvclN1YmplY3Qoc3RhdHVzKVxuICAgIH07XG4gIH1cblxuICBvcGVuRHJvcERvd24oaWQ6IHN0cmluZykge1xuICAgIHRoaXMuZHJvcGRvd25baWRdLnN0YXR1cy5uZXh0KHRydWUpO1xuICB9XG5cbiAgY2xvc2VEcm9wRG93bihpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5kcm9wZG93bltpZF0uc3RhdHVzLm5leHQoZmFsc2UpO1xuICB9XG5cbiAgd2F0Y2hEcm9wRG93bihpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuZHJvcGRvd25baWRdLnN0YXR1cy5hc09ic2VydmFibGUoKTtcbiAgfVxuXG4gIHJlZ2lzdGVyQ29sbGFwc2UoaWQ6IHN0cmluZywgc3RhdHVzOiBib29sZWFuKSB7XG4gICAgdGhpcy5jb2xsYXBzZVtpZF0gPSB7XG4gICAgICBpZCxcbiAgICAgIHN0YXR1czogbmV3IEJlaGF2aW9yU3ViamVjdChzdGF0dXMpXG4gICAgfTtcbiAgfVxuXG4gIG9wZW5Db2xsYXBzZShpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5jb2xsYXBzZVtpZF0uc3RhdHVzLm5leHQodHJ1ZSk7XG4gIH1cblxuICBjbG9zZUNvbGxhcHNlKGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLmNvbGxhcHNlW2lkXS5zdGF0dXMubmV4dChmYWxzZSk7XG4gIH1cblxuICB3YXRjaENvbGxhcHNlKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5jb2xsYXBzZVtpZF0uc3RhdHVzLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgZ2V0V2lkZ2V0SWQoaWQ6IHN0cmluZywgdHlwZTogc3RyaW5nLCBwYXJlbnRfaWQ6IHN0cmluZykge1xuICAgIHJldHVybiBpZCArICdfJyArIHR5cGUgKyAnXycgKyBwYXJlbnRfaWQ7XG4gIH1cblxuICB3aWRnZXRFeGlzdHMoaWQ6IHN0cmluZywgcGFyZW50X3R5cGU6IHN0cmluZywgcGFyZW50X2lkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy53aWRnZXRzW3RoaXMuZ2V0V2lkZ2V0SWQoaWQsIHBhcmVudF90eXBlLCBwYXJlbnRfaWQpXSA/IHRydWUgOiBmYWxzZTtcbiAgfVxuXG4gIHJlZ2lzdGVyV2lkZ2V0KGlkOiBzdHJpbmcsIHBhcmVudF90eXBlOiBzdHJpbmcsIHBhcmVudF9pZDogc3RyaW5nLCBvcHRpb25zOiBhbnkgPSB7fSkge1xuICAgIGxldCBteXdpZGdldGlkID0gdGhpcy5nZXRXaWRnZXRJZChpZCwgcGFyZW50X3R5cGUsIHBhcmVudF9pZCk7XG4gICAgdGhpcy53aWRnZXRzW215d2lkZ2V0aWRdID0ge1xuICAgICAgaWQsXG4gICAgICB0eXBlOiBwYXJlbnRfdHlwZSxcbiAgICAgIHBhcmVudF9pZDogcGFyZW50X2lkLFxuICAgICAgb3B0aW9uczogbmV3IEJlaGF2aW9yU3ViamVjdChvcHRpb25zKSxcbiAgICAgIHN0YXR1czogbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSlcbiAgICB9XG4gIH1cblxuICBvcGVuV2lkZ2V0KGlkOiBzdHJpbmcsIHBhcmVudF90eXBlOiBzdHJpbmcsIHBhcmVudF9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgbGV0IG15d2lkZ2V0aWQgPSB0aGlzLmdldFdpZGdldElkKGlkLCBwYXJlbnRfdHlwZSwgcGFyZW50X2lkKTtcbiAgICBpZiAodGhpcy53aWRnZXRzICYmIHRoaXMud2lkZ2V0c1tteXdpZGdldGlkXSkge1xuICAgICAgdGhpcy53aWRnZXRzW215d2lkZ2V0aWRdLnN0YXR1cy5uZXh0KHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIGNsb3NlV2lkZ2V0KGlkOiBzdHJpbmcsIHBhcmVudF90eXBlOiBzdHJpbmcsIHBhcmVudF9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgbGV0IG15d2lkZ2V0aWQgPSB0aGlzLmdldFdpZGdldElkKGlkLCBwYXJlbnRfdHlwZSwgcGFyZW50X2lkKTtcbiAgICBpZiAodGhpcy53aWRnZXRzICYmIHRoaXMud2lkZ2V0c1tteXdpZGdldGlkXSkge1xuICAgICAgdGhpcy53aWRnZXRzW215d2lkZ2V0aWRdLnN0YXR1cy5uZXh0KGZhbHNlKTtcbiAgICB9XG5cbiAgfVxuXG4gIGNsb3NlQWxsUGFyZW50V2lkZ2V0cyhwYXJlbnRfdHlwZTogc3RyaW5nLCBwYXJlbnRfaWQ6IHN0cmluZykge1xuICAgIGxldCBhbGxXaWRnZXRJZHMgPSBPYmplY3Qua2V5cyh0aGlzLndpZGdldHMpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsV2lkZ2V0SWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy53aWRnZXRzW2FsbFdpZGdldElkc1tpXV0udHlwZSA9PSBwYXJlbnRfdHlwZSAmJiB0aGlzLndpZGdldHNbYWxsV2lkZ2V0SWRzW2ldXS5wYXJlbnRfaWQgPT0gcGFyZW50X2lkKSB7XG4gICAgICAgIHRoaXMuY2xvc2VXaWRnZXQodGhpcy53aWRnZXRzW2FsbFdpZGdldElkc1tpXV0uaWQsIHBhcmVudF90eXBlLCBwYXJlbnRfaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHdhdGNoV2lkZ2V0KGlkOiBzdHJpbmcsIHBhcmVudF90eXBlOiBzdHJpbmcsIHBhcmVudF9pZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMud2lkZ2V0c1t0aGlzLmdldFdpZGdldElkKGlkLCBwYXJlbnRfdHlwZSwgcGFyZW50X2lkKV0uc3RhdHVzLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgd2F0Y2hPcHRpb25zKGlkOiBzdHJpbmcsIHBhcmVudF90eXBlOiBzdHJpbmcsIHBhcmVudF9pZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy53aWRnZXRzW3RoaXMuZ2V0V2lkZ2V0SWQoaWQsIHBhcmVudF90eXBlLCBwYXJlbnRfaWQpXS5vcHRpb25zLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgcmVnaXN0ZXJNZWdhTWVudShpZDogc3RyaW5nLCBsaW5rczogc3RyaW5nW10pIHtcbiAgICB0aGlzLm1lZ2FtZW51W2lkXSA9IHtcbiAgICAgIGlkLFxuICAgICAgYWN0aXZlOiBuZXcgQmVoYXZpb3JTdWJqZWN0KFwiXCIpXG4gICAgfTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyV2lkZ2V0KGxpbmtzW2ldLCBcIm1lZ2FtZW51XCIsIGlkKTtcbiAgICB9XG4gIH1cblxuICB3YXRjaE1lZ2FNZW51KGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5tZWdhbWVudVtpZF0uYWN0aXZlLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgb3Blbk1lZ2FNZW51KGlkOiBzdHJpbmcsIHRhcmdldGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLm1lZ2FtZW51W2lkXS5hY3RpdmUubmV4dCh0YXJnZXRpZCk7XG4gICAgaWYgKHRoaXMud2lkZ2V0RXhpc3RzKHRhcmdldGlkLCBcIm1lZ2FtZW51XCIsIGlkKSkge1xuICAgICAgdGhpcy5jbG9zZU1lZ2FNZW51KGlkKTtcbiAgICAgIHRoaXMub3BlbldpZGdldCh0YXJnZXRpZCwgXCJtZWdhbWVudVwiLCBpZCk7XG4gICAgfVxuICB9XG5cbiAgY2xvc2VNZWdhTWVudShpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5jbG9zZUFsbFBhcmVudFdpZGdldHMoXCJtZWdhbWVudVwiLCBpZCk7XG4gICAgdGhpcy5tZWdhbWVudVtpZF0uYWN0aXZlLm5leHQoZmFsc2UpO1xuICB9XG5cbiAgZmFsbGJhY2tDb3B5VGV4dFRvQ2xpcGJvYXJkKHRleHQ6c3RyaW5nKSB7XG4gICAgdmFyIHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xuICAgIHRleHRBcmVhLnZhbHVlID0gdGV4dDtcbiAgICBcbiAgICAvLyBBdm9pZCBzY3JvbGxpbmcgdG8gYm90dG9tXG4gICAgdGV4dEFyZWEuc3R5bGUudG9wID0gXCIwXCI7XG4gICAgdGV4dEFyZWEuc3R5bGUubGVmdCA9IFwiMFwiO1xuICAgIHRleHRBcmVhLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xuICBcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRleHRBcmVhKTtcbiAgICB0ZXh0QXJlYS5mb2N1cygpO1xuICAgIHRleHRBcmVhLnNlbGVjdCgpO1xuICBcbiAgICB0cnkge1xuICAgICAgdmFyIHN1Y2Nlc3NmdWwgPSBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpO1xuICAgICAgdmFyIG1zZyA9IHN1Y2Nlc3NmdWwgPyAnc3VjY2Vzc2Z1bCcgOiAndW5zdWNjZXNzZnVsJztcbiAgICAgIGNvbnNvbGUubG9nKCdGYWxsYmFjazogQ29weWluZyB0ZXh0IGNvbW1hbmQgd2FzICcgKyBtc2cpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFsbGJhY2s6IE9vcHMsIHVuYWJsZSB0byBjb3B5JywgZXJyKTtcbiAgICB9XG4gIFxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGV4dEFyZWEpO1xuICB9XG4gIGNvcHlUb0NsaXBib2FyZCh0ZXh0OnN0cmluZykge1xuICAgIGlmICghbmF2aWdhdG9yLmNsaXBib2FyZCkge1xuICAgICAgdGhpcy5mYWxsYmFja0NvcHlUZXh0VG9DbGlwYm9hcmQodGV4dCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHQpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZygnQXN5bmM6IENvcHlpbmcgdG8gY2xpcGJvYXJkIHdhcyBzdWNjZXNzZnVsIScpO1xuICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcignQXN5bmM6IENvdWxkIG5vdCBjb3B5IHRleHQ6ICcsIGVycik7XG4gICAgfSk7XG4gIH1cblxuXG5cbn1cbiJdfQ==